<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.4.1/css/simple-line-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
    <title>Blog</title>
</head>

<body class="bg-dark">

    <!-- START OF HEADER -->

    <div class="jumbotron bg-dark">
        <h1 class="display-4 text-light">Reversing challenges</h1>
        <p class="lead text-light">In this web you will find solutions to reversing challenges</p>
    </div>

    <!-- END OF HEADER -->

    <!-- START OF PROGRESS BAR -->

    <div class="progress sticky-top progress-container">
        <div class="progress-bar progress-bar-striped progress-bar-animated" id="myBar" role="progressbar"
            aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div>
    </div>
    <!-- END OF PROGRESS BAR -->

    <!-- START OF NAVBAR -->

    <ul class="nav nav-pills mb-3 sticky-top bg-dark" id="pills-tab" role="tablist" style="top: 15px;">
        <li class="nav-item bg-dark">
            <a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-osint" role="tab"
                aria-controls="pills-osint" aria-selected="true">Reversing - Impossible Password</a>
        </li>
        <li class="nav-item">
            <a class="nav-link bg-dark disabled" id="pills-profile-tab" data-toggle="pill" href="#pills-reverse"
                role="tab" aria-controls="pills-reverse" aria-selected="false" title="Under development">Osint
                <span class="badge badge-secondary">In progress</span>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="pills-contact-tab" data-toggle="pill" href="#pills-contact" role="tab"
                aria-controls="pills-contact" aria-selected="false"> Contact
            </a>
        </li>
        <br>
    </ul>

    <!-- END OF NAVBAR -->

    <!-- START OF REVERSING CONTENT -->

    <div class="tab-content" id="pills-tabContent">
        <div class="tab-pane fade show active text-light" id="pills-osint" role="tabpanel"
            aria-labelledby="pills-home-tab">
            <h1>Impossible Password</h1>
            <h2>Setting everything up</h2>
            <p>You can donwload the binary file with the following <a href="impossible_password.bin">link</a></p>
            <p>You will also need <a href="https://ghidra-sre.org/">Ghidra</a></p>
            <p>Some basic Python knwoledge and a code editor.</p>
            <h2>Starting the reversing</h2>
            <p>First let's see the functions in Ghidra</p>

            <!-- START OF IMGS -->

            <div id="carouselExampleControls2" class="carousel slide" data-ride="carousel"
                style="width: 55%;right: -20%;">
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img class="d-block w-100" src="img/ghidra1.png" alt="First slide">
                    </div>
                </div>
            </div>

            <!-- END OF IMGS -->

            <!-- CONTINUE CONTENT -->

            <p>We can see a function called <b>FUN_0040085d</b>. Inside that function we will see the following code</p>
            <pre class="lang-c" style="background-color:#dfe6e9;"><code class="lang-c">
                void FUN_0040085d(void) {
                    int iVar1;
                    char *__s2;
                    byte local_48;
                    undefined local_47;
                    undefined local_46;
                    undefined local_45;
                    undefined local_44;
                    undefined local_43;
                    undefined local_42;
                    undefined local_41;
                    undefined local_40;
                    undefined local_3f;
                    undefined local_3e;
                    undefined local_3d;
                    undefined local_3c;
                    undefined local_3b;
                    undefined local_3a;
                    undefined local_39;
                    undefined local_38;
                    undefined local_37;
                    undefined local_36;
                    undefined local_35;
                    char local_28 [20];
                    int local_14;
                    char *local_10;
                    
                    local_10 = "SuperSeKretKey";
                    local_48 = 0x41;
                    local_47 = 0x5d;
                    local_46 = 0x4b;
                    local_45 = 0x72;
                    local_44 = 0x3d;
                    local_43 = 0x39;
                    local_42 = 0x6b;
                    local_41 = 0x30;
                    local_40 = 0x3d;
                    local_3f = 0x30;
                    local_3e = 0x6f;
                    local_3d = 0x30;
                    local_3c = 0x3b;
                    local_3b = 0x6b;
                    local_3a = 0x31;
                    local_39 = 0x3f;
                    local_38 = 0x6b;
                    local_37 = 0x38;
                    local_36 = 0x31;
                    local_35 = 0x74;
                    printf("* ");
                    __isoc99_scanf(&DAT_00400a82,local_28);
                    printf("[%s]\n",local_28);
                    local_14 = strcmp(local_28,local_10);
                    if (local_14 != 0) {
                                        /* WARNING: Subroutine does not return */
                        exit(1);
                    }
                    printf("** ");
                    __isoc99_scanf(&DAT_00400a82,local_28);
                    __s2 = (char *)FUN_0040078d(0x14);
                    iVar1 = strcmp(local_28,__s2);
                    if (iVar1 == 0) {
                        FUN_00400978(&local_48);
                    }
                    return;
                }
            </code>
            </pre>
            <p>If we take a closer look we will see a variable that seems to be a password:<br><code
                    class="lang-c">local_10 = "SuperSeKretKey";</code><br>We can see what happens if why try to input
                that password</p>
            <!-- START OF IMGS -->

            <div id="carouselExampleControls" class="carousel slide" data-ride="carousel"
                style="width: 55%;right: -20%;">
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img class="d-block w-100" src="img/imppass1.png" alt="First slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100" src="img/imppass2.png" alt="Second slide">
                    </div>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
            <p>As we can see it will print a second line with two <kbd>**</kbd>. That means that we have just bypassed
                the following block of code</p>
            <pre>
                <code class="lang-c">
                    local_14 = strcmp(local_28,local_10);
                    if (local_14 != 0) {
                        exit(1);
                    }
                </code>
            </pre>
            <p>Now we can see that this function calls other function called <b>FUN_0040078d</b>, let's take a look
                inside that function</p>
            <pre>
                <code class="lang-c">
                    void * FUN_0040078d(int param_1) {
                        int iVar1;
                        time_t tVar2;
                        void *pvVar3;
                        int local_c;
                        
                        tVar2 = time((time_t *)0x0);
                        DAT_00601074 = DAT_00601074 + 1;
                        srand(DAT_00601074 + (int)tVar2 * param_1);
                        pvVar3 = malloc((long)(param_1 + 1));
                        if (pvVar3 != (void *)0x0) {
                            local_c = 0;
                            while (local_c < param_1) {
                            iVar1 = rand();
                            *(char *)((long)local_c + (long)pvVar3) = (char)(iVar1 % 0x5e) + '!';
                            local_c = local_c + 1;
                            }
                            *(undefined *)((long)pvVar3 + (long)param_1) = 0;
                            return pvVar3;
                        }
                                            /* WARNING: Subroutine does not return */
                        exit(1);
                    }
                </code>
            </pre>
            <p>Now we understand the reason of the challenge name. It will be very hard to know what this functions do,
                so let's take a look again to the previous function</p>
            <pre>
                <code class="lang-c">
                    if (iVar1 == 0) {
                        FUN_00400978(&local_48);
                    }
                </code>
            </pre>
            <p>We can see that it calls other function, so let's take a look inside it</p>
            <pre>
                <code class="lang-c">
                    void FUN_00400978(byte *param_1) {
                        int local_14;
                        byte *local_10;
                        
                        local_14 = 0;
                        local_10 = param_1;
                        while ((*local_10 != 9 && (local_14 < 0x14))) {
                            putchar((int)(char)(*local_10 ^ 9));
                            local_10 = local_10 + 1;
                            local_14 = local_14 + 1;
                        }
                        putchar(10);
                        return;
                    }
                </code>
            </pre>
            <p>We can see a XOR operator<br>
                <pre><code class="lang-c">putchar((int)(char)(*local_10 ^ 9));</code></pre>
            </p>
            <p>With all this info, let's go back to the main function and take all local vars except local_10, and then
                let's convert them to ascii code</p>
            <p><kbd>A]Kr=9k0=0o0;k1?k81t</kbd> will be the resultant string, so now we have to reproduce the following
                line of code</p>
            <pre><code class="lang-c">putchar((int)(char)(*local_10 ^ 9));</code></pre>
            <p>I will reproduce it in python</p>
            <pre><code class="lang-python">
                for final in "A]Kr=9k0=0o0;k1?k81t":
                    print(chr(ord(final) ^ 9), end='')</code></pre>
            <p>And the result will be the flag :D</p>
            <!-- END OF IMGS -->
        </div>

        <!-- END OF REVERSING CONTENT -->

        <!-- START OF CONTACT CONTENT -->

        <div class="tab-pane fade text-light" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab">
            <form>
                <div class="form-group row">
                    <label for="inputEmail3" class="col-sm-2 col-form-label">Email</label>
                    <div class="col-sm-10">
                        <input type="email" class="form-control" id="inputEmail3" placeholder="Email">
                    </div>
                </div>

                <div class="form-group row">
                    <label for="inputEmail3" class="col-sm-2 col-form-label">Nombre</label>
                    <div class="col-sm-10">
                        <input type="name" class="form-control" id="inputName" placeholder="Name">
                    </div>
                </div>

                <div class="form-group row">
                    <label for="inputPassword3" class="col-sm-2 col-form-label">Password</label>
                    <div class="col-sm-10">
                        <input type="password" class="form-control" id="inputPassword3" placeholder="Password">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="inputPassword3" class="col-sm-2 col-form-label">Confirm password</label>
                    <div class="col-sm-10">
                        <input type="password" class="form-control" id="inputPassword3" placeholder="Password">
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-sm-2">Privacy policy</div>
                    <div class="col-sm-10">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="gridCheck1">
                            <label class="form-check-label" for="gridCheck1">
                                Please <a href="exampleModalScrollable" data-toggle="modal"
                                    data-target="#exampleModalScrollable">READ</a> our privacy policy
                            </label>
                        </div>
                    </div>
                </div>
                <!-- Button trigger modal -->
                <!-- Modal -->
                <div class="modal fade" id="exampleModalScrollable" tabindex="-1" role="dialog"
                    aria-labelledby="exampleModalScrollableTitle" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-scrollable" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalScrollableTitle">Modal title</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body text-light">
                                Generic privacy policy template

                                This privacy policy ("policy") will help you understand how Reversing challenges ("us",
                                "we", "our") uses and protects the data you provide to us when you visit and use
                                [website] ("website", "service").

                                We reserve the right to change this policy at any given time, of which you will be
                                promptly updated. If you want to make sure that you are up to date with the latest
                                changes, we advise you to frequently visit this page.

                                What User Data We Collect

                                When you visit the website, we may collect the following data:

                                Your IP address.
                                Your contact information and email address.
                                Other information such as interests and preferences.
                                Data profile regarding your online behavior on our website.

                                Why We Collect Your Data

                                We are collecting your data for several reasons:

                                To better understand your needs.
                                To improve our services and products.
                                To send you promotional emails containing the information we think you will find
                                interesting.
                                To contact you to fill out surveys and participate in other types of market research.
                                To customize our website according to your online behavior and personal preferences.

                                Safeguarding and Securing the Data

                                Reversing challenges is committed to securing your data and keeping it confidential.
                                Reversing challenges has done all in its power to prevent data theft, unauthorized
                                access, and disclosure by implementing the latest technologies and software, which help
                                us safeguard all the information we collect online.

                                Our Cookie Policy

                                Once you agree to allow our website to use cookies, you also agree to use the data it
                                collects regarding your online behavior (analyze web traffic, web pages you spend the
                                most time on, and websites you visit).

                                The data we collect by using cookies is used to customize our website to your needs.
                                After we use the data for statistical analysis, the data is completely removed from our
                                systems.

                                Please note that cookies don't allow us to gain control of your computer in any way.
                                They are strictly used to monitor which pages you find useful and which you do not so
                                that we can provide a better experience for you.

                                If you want to disable cookies, you can do it by accessing the settings of your internet
                                browser. (Provide links for cookie settings for major internet browsers).

                                Links to Other Websites

                                Our website contains links that lead to other websites. If you click on these links
                                Reversing challenges is not held responsible for your data and privacy protection.
                                Visiting those websites is not governed by this privacy policy agreement. Make sure to
                                read the privacy policy documentation of the website you go to from our website.

                                Restricting the Collection of your Personal Data

                                At some point, you might wish to restrict the use and collection of your personal data.
                                You can achieve this by doing the following:

                                When you are filling the forms on the website, make sure to check if there is a box
                                which you can leave unchecked, if you don't want to disclose your personal information.
                                If you have already agreed to share your information with us, feel free to contact us
                                via email and we will be more than happy to change this for you.

                                Reversing challenges will not lease, sell or distribute your personal information to any
                                third parties, unless we have your permission. We might do so if the law forces us. Your
                                personal information will be used when we need to send you promotional materials if you
                                agree to this privacy policy.
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                <button type="button" class="btn btn-primary">Save changes</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-sm-10">
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </div>
                </div>
            </form>
        </div>

        <!-- END OF CONTACT CONTENT -->

    </div>

    <!-- END OF CONTENT -->

    <!-- START OF FOOTER -->

    <footer class="footer bg-secondary">
        <div class="container-fluid text-center text-md-left">
            <br>
            <!-- Grid row -->
            <div class="row">

                <!-- Grid column -->
                <div class="col-md-8 mt-md-0 mt-2">

                    <div class="card bg-dark" style="width: 18rem; right: -150px;">
                        <div class="card-body">
                            <h6 class="card-subtitle mb-2 text-muted text-light">Hack The Box profile</h6>
                            <p class="card-text text-light">You can give me respect in <a
                                    href="https://www.hackthebox.eu/home/users/profile/162065">HTB</a></p>
                            <script src="https://www.hackthebox.eu/badge/162065"></script>
                        </div>
                    </div>

                </div>
                <!-- Grid column -->

                <hr class="clearfix w-100 d-md-none pb-3">

                <!-- Grid column -->
                <div class="col-md-0 mb-md-0 mb-3">

                    <!-- Links -->
                    <h5 class="text-uppercase">Social</h5>

                    <ul class="list-unstyled">
                        <li class="icon-social-twitter">
                            <a href="https://twitter.com/W4nn4Die">My twitter account</a>
                        </li>
                        <li class="icon-social-github">
                            <a href="https://github.com/PedroCisnerosSantana">My github profile</a>
                        </li>
                    </ul>

                </div>
                <!-- Grid column -->

            </div>
            <!-- Grid row -->

        </div>
        <!-- Footer Links -->
        <br>
        <!-- Copyright -->
        <div class="footer-copyright text-center py-3 bg-dark text-light">© 2020 Copyright:
            <p>Pedro Cisneros Santana</p>
        </div>
        <!-- Copyright -->
    </footer>

    <!-- END OF FOOTER -->

    <!-- ADDING SCRIPTS TO THE END OF THE CONTENT TO IMPROVE WEB SPEED -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="js/progress.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/components/prism-core.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <!-- END -->
</body>

</html>